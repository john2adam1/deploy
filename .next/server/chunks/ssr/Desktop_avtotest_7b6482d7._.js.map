{"version":3,"sources":["../../../../../../Desktop/avtotest/lib/access-control.ts","../../../../../../Desktop/avtotest/components/test-interface.tsx/__nextjs-internal-proxy.mjs","../../../../../../Desktop/avtotest/app/test/%5BcategoryId%5D/page.tsx"],"sourcesContent":["import type { User } from \"./types\"\r\n\r\nexport function hasActiveAccess(user: User): boolean {\r\n  const now = new Date()\r\n  const trialEnd = new Date(user.trial_end)\r\n  const subscriptionEnd = user.subscription_end ? new Date(user.subscription_end) : null\r\n\r\n  return trialEnd > now || (subscriptionEnd !== null && subscriptionEnd > now)\r\n}\r\n\r\nexport function getTimeRemaining(endTime: string) {\r\n  const now = new Date()\r\n  const end = new Date(endTime)\r\n  const diff = end.getTime() - now.getTime()\r\n\r\n  if (diff <= 0) {\r\n    return {\r\n      expired: true,\r\n      hours: 0,\r\n      minutes: 0,\r\n      seconds: 0,\r\n    }\r\n  }\r\n\r\n  const hours = Math.floor(diff / (1000 * 60 * 60))\r\n  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60))\r\n  const seconds = Math.floor((diff % (1000 * 60)) / 1000)\r\n\r\n  return {\r\n    expired: false,\r\n    hours,\r\n    minutes,\r\n    seconds,\r\n  }\r\n}\r\n\r\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const TestInterface = registerClientReference(\n    function() { throw new Error(\"Attempted to call TestInterface() from the server but TestInterface is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Desktop/avtotest/components/test-interface.tsx\",\n    \"TestInterface\",\n);\n","import { redirect } from \"next/navigation\"\r\nimport { getSupabaseServerClient } from \"@/lib/supabase/server\"\r\nimport { Navbar } from \"@/components/navbar\"\r\nimport { hasActiveAccess } from \"@/lib/access-control\"\r\nimport { TestInterface } from \"@/components/test-interface\"\r\n\r\nexport default async function TestPage({ params }: { params: Promise<{ categoryId: string }> }) {\r\n  const { categoryId } = await params\r\n  const supabase = await getSupabaseServerClient()\r\n\r\n  const {\r\n    data: { user },\r\n  } = await supabase.auth.getUser()\r\n  if (!user) redirect(\"/login\")\r\n\r\n  const { data: userData } = await supabase.from(\"users\").select(\"*\").eq(\"id\", user.id).single()\r\n\r\n  if (!userData || !hasActiveAccess(userData)) {\r\n    redirect(\"/dashboard\")\r\n  }\r\n\r\n  const { data: category } = await supabase.from(\"categories\").select(\"*\").eq(\"id\", categoryId).single()\r\n\r\n  const { data: tests } = await supabase.from(\"tests\").select(\"*\").eq(\"category_id\", categoryId).order(\"created_at\")\r\n\r\n  if (!category || !tests?.length) {\r\n    redirect(\"/dashboard\")\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <Navbar userEmail={user.email} isAdmin={userData.role === \"admin\"} />\r\n      <TestInterface categoryTitle={category.title} tests={tests} userId={user.id} />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"8KAEO,SAAS,EAAgB,CAAU,EACxC,IAAM,EAAM,IAAI,KACV,EAAW,IAAI,KAAK,EAAK,SAAS,EAClC,EAAkB,EAAK,gBAAgB,CAAG,IAAI,KAAK,EAAK,gBAAgB,EAAI,KAElF,OAAO,EAAW,GAA4B,OAApB,GAA4B,EAAkB,CAC1E,wDCNO,IAAM,EAAgB,CAAA,EAD7B,AAC6B,EAD7B,CAAA,CAAA,OAC6B,uBAAA,AAAuB,EAChD,WAAa,MAAM,AAAI,MAAM,wOAA0O,EACvQ,+EACA,oEAHG,IAAM,EAAgB,CAAA,EAAA,AAD7B,EAAA,CAAA,CAAA,OAC6B,uBAAA,AAAuB,EAChD,WAAa,MAAU,AAAJ,MAAU,wOAA0O,EACvQ,2DACA,gJCLJ,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEe,eAAe,EAAS,QAAE,CAAM,CAA+C,EAC5F,GAAM,YAAE,CAAU,CAAE,CAAG,MAAM,EACvB,EAAW,MAAM,CAAA,EAAA,EAAA,uBAAA,AAAuB,IAExC,CACJ,KAAM,MAAE,CAAI,CAAE,CACf,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,EAC3B,CAAC,GAAM,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,UAEpB,GAAM,CAAE,KAAM,CAAQ,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,SAAS,MAAM,CAAC,KAAK,EAAE,CAAC,KAAM,EAAK,EAAE,EAAE,MAAM,EAExF,CAAC,GAAa,CAAA,EAAA,EAAA,IAAD,WAAC,AAAe,EAAC,IAChC,CAAA,EAAA,EAAA,EAD2C,MACnC,AAAR,EAAS,cAGX,GAAM,CAAE,KAAM,CAAQ,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,cAAc,MAAM,CAAC,KAAK,EAAE,CAAC,KAAM,GAAY,MAAM,GAE9F,CAAE,KAAM,CAAK,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,SAAS,MAAM,CAAC,KAAK,EAAE,CAAC,cAAe,GAAY,KAAK,CAAC,cAMrG,OAJI,AAAC,GAAa,GAAO,MAAR,EACf,AAD+B,AAC/B,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,cAIT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAW,EAAK,KAAK,CAAE,QAA2B,UAAlB,EAAS,IAAI,GACrD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CAAC,cAAe,EAAS,KAAK,CAAE,MAAO,EAAO,OAAQ,EAAK,EAAE,KAGjF","ignoreList":[1]}